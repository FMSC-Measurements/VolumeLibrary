! This is from FIA package code NIMS_VOL_FIA_SE_PKB
! CREATED BY YW 2018/08/02
! SRS_CV4   - CU000067 CUBIC VOLUME FROM STUMP TO 4 INCH TOP
! SRS_TCU   - CU000068 CUBIC VOLUME FROM STUMP TO TIP
! SRS_CUSAW - CU000069 CUBIC VOLUME FOR SAWLOG PORTION
! SRS_BD    - BD000049 SAWLOG BOARDFOOT VOLUME
! Reference:
! Joe McClure and Noel Cost - Unpublished
! NVEL EQUATION NUMBER:
! S00SRS0*** (where *** is the species in VOLSP)
! EQUATION FOR PLANTATION:
! S00SRS1111 S00SRS1131 
! THE 7TH CHARACTER IN THE EQUATION NUMBER: 0 = NATURAL, 1 = PLANTATION
      SUBROUTINE SRS_VOL(VOLEQ,DBHOB,HTTOT,BFMIND,VOL,ERRFLG)
      CHARACTER*10 VOLEQ
      REAL DBHOB,HTTOT,VOL(15),BFMIND
      INTEGER ERRFLG,SPN,I,J,IDX,CNT,VOLSP(85)
      REAL DBH,HT,TCU,MCU,SAWCU,BD,RC,RB,CV4,TF
      REAL CUCOEF(85,7),TFCOEF(85,5),BFCOEF(85,5)
      REAL A1,A2,B1,B2,C1,C2,D1,D2,E1,E2,F1,F2,G1,G2,H1,H2,I1,I2
      DATA VOLSP/
     &  10, 43, 60, 67, 68, 90,107,110,111,115,
     & 121,123,126,128,129,131,132,221,222,241,
     & 260,311,313,316,317,318,330,370,371,400,
     & 460,491,521,531,540,552,555,580,591,601,
     & 602,611,621,651,652,653,680,691,693,694,
     & 731,740,741,762,802,804,806,808,812,813,
     & 817,820,822,823,825,826,827,830,831,832,
     & 833,834,835,837,838,899,824,840,842,836,
     & 901,920,950,970,999/
!    SRS Gross cubic volume stump to 4 inch top from total height
!    Sapling (column 2 & 3), pole (column 4 & 5)  and saw (column 6 & 7)   
      DATA ((CUCOEF(J,I), I=1,7), J=1,85) /
     & 10,0.065755,0.002813,-0.09992,0.002097,0.879371,0.001845,
     & 43,0.010169,0.002839,0.247418,0.002161,1.668389,0.001822,
     & 60,0.052928,0.002853,-0.315878,0.002207,-0.104252,0.002145,
     & 67,0.052928,0.002853,-0.315878,0.002207,-0.104252,0.002145,
     & 68,0.052928,0.002853,-0.315878,0.002207,-0.104252,0.002145,
     & 90,0.065755,0.002813,-0.09992,0.002097,0.879371,0.001845,
     & 107,0.079225,0.00249,-0.514855,0.002472,0.377006,0.002239,
     & 110,0.066654,0.002168,-0.706167,0.002215,-0.68706,0.002211,
     & 111,0.070229,0.002111,-0.797881,0.002128,-0.611225,0.002088,
     & 115,0.081287,0.002219,0.248714,0.002143,0.118241,0.002168,
     & 121,0.058586,0.002429,-0.944222,0.002265,-0.44319,0.002165,
     & 123,0.081287,0.002219,-0.013552,0.002453,0.870587,0.002205,
     & 126,0.081287,0.002219,-0.47066,0.002194,-0.37967,0.002171,
     & 128,0.047587,0.002354,-0.632942,0.002177,-0.2796,0.002093,
     & 129,0.074791,0.002881,-0.040964,0.002011,0.604023,0.001857,
     & 131,0.060342,0.002197,-0.819681,0.00214,-0.658316,0.002107,
     & 132,0.034943,0.002569,-0.284955,0.002264,0.333364,0.002118,
     & 221,0.094132,0.002743,0.241431,0.002047,1.757944,0.001752,
     & 222,0.101432,0.002744,-0.296106,0.002037,1.044195,0.001712,
     & 241,0.065755,0.002813,-0.09992,0.002097,0.879371,0.001845,
     & 260,0.065755,0.002813,-0.259181,0.001808,-0.216081,0.001798,
     & 311,0.058647,0.002378,-0.347844,0.001837,-0.202284,0.001818,
     & 313,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 316,0.023326,0.00286,-0.104018,0.00185,0.680247,0.001742,
     & 317,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 318,0.058647,0.002378,-0.052827,0.001891,0.352087,0.001838,
     & 330,0.054564,0.002565,-0.439762,0.00194,0.218924,0.001833,
     & 370,0.058647,0.002378,0.371605,0.001773,0.543581,0.001751,
     & 371,0.058647,0.002378,0.998628,0.001765,0.169526,0.001893,
     & 400,0.04762,0.002192,-0.665929,0.001868,-0.793179,0.001884,
     & 460,0.054564,0.002565,-0.19368,0.00177,0.500522,0.00167,
     & 491,0.037005,0.002729,-0.347844,0.001837,-0.202284,0.001818,
     & 521,0.034641,0.002546,-0.402944,0.001931,-1.173042,0.002028,
     & 531,0.058647,0.002378,-0.398996,0.002026,1.468854,0.001765,
     & 540,0.064004,0.00241,-0.392822,0.001921,0.172701,0.001851,
     & 552,0.058647,0.002378,-0.347844,0.001837,-0.202284,0.001818,
     & 555,0.012745,0.003005,-0.19841,0.001901,0.735415,0.001775,
     & 580,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 591,0.058647,0.002378,-0.172555,0.002151,0.762909,0.001965,
     & 601,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 602,0.058647,0.002378,-0.033805,0.001656,0.42189,0.001596,
     & 611,0.045146,0.002357,-0.936122,0.001991,-0.629168,0.001955,
     & 621,0.019361,0.002514,-0.553182,0.001922,0.485232,0.001807,
     & 651,0.051279,0.002641,-0.19841,0.001901,0.735415,0.001775,
     & 652,0.051279,0.002641,-0.19841,0.001901,0.735415,0.001775,
     & 653,0.057904,0.002603,-0.19841,0.001901,0.735415,0.001775,
     & 680,0.058647,0.002378,-0.347844,0.001837,-0.202284,0.001818,
     & 691,0.062785,0.002458,-0.267107,0.001904,1.749738,0.001659,
     & 693,0.048582,0.002498,-0.225146,0.001902,0.69073,0.001767,
     & 694,0.088427,0.002681,-0.466949,0.001972,1.284413,0.00176,
     & 731,0.054564,0.002565,0.229691,0.001901,2.326908,0.001649,
     & 740,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 741,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 762,0.155471,0.002461,-0.5472,0.001948,-0.607326,0.001957,
     & 802,0.044339,0.002539,-0.37698,0.001948,0.148434,0.00188,
     & 804,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 806,0.067831,0.00266,-0.225632,0.001917,0.003343,0.001887,
     & 808,0.080702,0.002467,-0.316577,0.001817,-0.085426,0.001783,
     & 812,0.080702,0.002467,-0.316577,0.001817,-0.085426,0.001783,
     & 813,0.041238,0.002603,0.046929,0.00195,1.212451,0.001791,
     & 817,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 820,0.024511,0.002637,-0.351135,0.002014,0.846919,0.00184,
     & 822,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 823,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 825,0.041238,0.002603,0.343571,0.001822,0.376354,0.001818,
     & 826,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 827,0.030987,0.00267,-0.265687,0.001986,1.195722,0.001795,
     & 830,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 831,0.041238,0.002603,-0.38348,0.001893,-0.460755,0.001904,
     & 832,0.014284,0.002521,-0.377981,0.001859,-0.069945,0.001818,
     & 833,0.041238,0.002603,-0.095806,0.001889,0.793996,0.001779,
     & 834,0.041238,0.002603,-0.279035,0.001894,0.248363,0.001823,
     & 835,0.051922,0.002631,-0.361464,0.001892,0.301286,0.001791,
     & 837,0.042519,0.002613,-0.513128,0.001775,-0.515373,0.001775,
     & 838,0.05082,0.002776,0.459129,0.00156,0.344387,0.00158,
     & 899,0.053215,0.002475,-0.18395,0.001841,-0.035319,0.001807,
     & 824,0.053215,0.002475,-0.18395,0.001841,-0.035319,0.001807,
     & 840,0.053215,0.002475,-0.18395,0.001841,-0.035319,0.001807,
     & 842,0.053215,0.002475,-0.18395,0.001841,-0.035319,0.001807,
     & 836,0.053215,0.002475,-0.18395,0.001841,-0.035319,0.001807,
     & 901,0.058647,0.002378,-0.206213,0.001592,0.603856,0.001483,
     & 920,0.054564,0.002565,-0.451948,0.001921,0.518892,0.001802,
     & 950,0.054564,0.002565,0.198966,0.00186,0.0344,0.001882,
     & 970,0.032199,0.002589,-0.155066,0.001828,-0.316005,0.001851,
     & 999,0.062125,0.002494,-0.37883,0.001855,0.82352,0.00163/
!--Coefficient to convert trees from CV4 (4 inch top) to CV (total stem)
!--   POLES (column 2 & 3) SAW (column 4 & 5)
      DATA ((TFCOEF(J,I), I=1,5), J=1,85) /
     & 10,1.146541,2.146242,1.146541,2.146242,
     & 43,1.152171,1.259555,1.152171,1.259555,
     & 60,1.176439,2.550195,1.176439,2.550195,
     & 67,1.176439,2.550195,1.176439,2.550195,
     & 68,1.176439,2.550195,1.176439,2.550195,
     & 90,1.146541,2.146242,1.146541,2.146242,
     & 107,1.112564,2.775872,1.112564,2.775872,
     & 110,1.113788,2.208955,1.113788,2.208955,
     & 111,1.109247,2.429713,1.109247,2.429713,
     & 115,1.116228,2.142989,1.116228,2.142989,
     & 121,1.107343,2.38436,1.107343,2.38436,
     & 123,1.127272,1.123936,1.127272,1.123936,
     & 126,1.13931,1.300282,1.13931,1.300282,
     & 128,1.125409,1.87711,1.125409,1.87711,
     & 129,1.145631,1.610693,1.145631,1.610693,
     & 131,1.11178,2.47363,1.11178,2.47363,
     & 132,1.134089,1.53146,1.134089,1.53146,
     & 221,1.188594,2.394869,1.188594,2.394869,
     & 222,1.237591,3.561137,1.237591,3.561137,
     & 241,1.146541,2.146242,1.146541,2.146242,
     & 260,1.131783,2.320512,1.131783,2.320512,
     & 311,1.186636,2.417775,1.186636,2.417775,
     & 313,1.145017,2.255001,1.145017,2.255001,
     & 316,1.179791,1.882807,1.179791,1.882807,
     & 317,1.145017,2.255001,1.145017,2.255001,
     & 318,1.190063,1.712613,1.190063,1.712613,
     & 330,1.172535,1.535447,1.172535,1.535447,
     & 370,1.21617,1.355783,1.21617,1.355783,
     & 371,1.212153,1.359713,1.212153,1.359713,
     & 400,1.189261,3.074669,1.189261,3.074669,
     & 460,1.188803,1.641479,1.188803,1.641479,
     & 491,1.186636,2.417775,1.186636,2.417775,
     & 521,1.214404,1.834798,1.214404,1.834798,
     & 531,1.219447,2.401295,1.219447,2.401295,
     & 540,1.128655,2.34928,1.128655,2.34928,
     & 552,1.186636,2.417775,1.186636,2.417775,
     & 555,1.152686,2.649964,1.152686,2.649964,
     & 580,1.145017,2.255001,1.145017,2.255001,
     & 591,1.203433,1.865955,1.203433,1.865955,
     & 601,1.145017,2.255001,1.145017,2.255001,
     & 602,1.173659,1.863595,1.173659,1.863595,
     & 611,1.122118,2.802714,1.122118,2.802714,
     & 621,1.115123,1.788864,1.115123,1.788864,
     & 651,1.158363,2.382274,1.158363,2.382274,
     & 652,1.158363,2.382274,1.158363,2.382274,
     & 653,1.166687,2.242538,1.166687,2.242538,
     & 680,1.186636,2.417775,1.186636,2.417775,
     & 691,1.264347,1.8217,1.264347,1.8217,
     & 693,1.15664,2.035818,1.15664,2.035818,
     & 694,1.187896,2.444066,1.187896,2.444066,
     & 731,1.150504,1.590116,1.150504,1.590116,
     & 740,1.145017,2.255001,1.145017,2.255001,
     & 741,1.145017,2.255001,1.145017,2.255001,
     & 762,1.164183,1.513173,1.164183,1.513173,
     & 802,1.223605,2.051445,1.223605,2.051445,
     & 804,1.218003,2.181659,1.218003,2.181659,
     & 806,1.216303,1.553713,1.216303,1.553713,
     & 808,1.206835,3.453587,1.206835,3.453587,
     & 812,1.206835,3.453587,1.206835,3.453587,
     & 813,1.223374,1.367666,1.223374,1.367666,
     & 817,1.218003,2.181659,1.218003,2.181659,
     & 820,1.237288,2.395208,1.237288,2.395208,
     & 822,1.218003,2.181659,1.218003,2.181659,
     & 823,1.218003,2.181659,1.218003,2.181659,
     & 825,1.237249,1.578554,1.237249,1.578554,
     & 826,1.218003,2.181659,1.218003,2.181659,
     & 827,1.224892,2.664642,1.224892,2.664642,
     & 830,1.218003,2.181659,1.218003,2.181659,
     & 831,1.202078,3.487957,1.202078,3.487957,
     & 832,1.205365,1.671724,1.205365,1.671724,
     & 833,1.224449,1.277306,1.224449,1.277306,
     & 834,1.218003,2.181659,1.218003,2.181659,
     & 835,1.237511,2.241176,1.237511,2.241176,
     & 837,1.21424,2.375921,1.21424,2.375921,
     & 838,1.193954,4.298451,1.193954,4.298451,
     & 899,1.218003,2.181659,1.218003,2.181659,
     & 824,1.218003,2.181659,1.218003,2.181659,
     & 840,1.218003,2.181659,1.218003,2.181659,
     & 842,1.218003,2.181659,1.218003,2.181659,
     & 836,1.218003,2.181659,1.218003,2.181659,
     & 901,1.194258,1.609426,1.194258,1.609426,
     & 920,1.145017,2.255001,1.145017,2.255001,
     & 950,1.135107,1.257835,1.135107,1.257835,
     & 970,1.159555,2.270106,1.159555,2.270106,
     & 999,1.218003,2.181659,1.218003,2.181659/
!--Coefficient to convert trees from CV4 (4 inch top) to cubic sawlog portion and boardfoot      
!--   saw cubicfoot (column 2 & 3) SAW boardfoot (column 4 & 5)
      DATA ((BFCOEF(J,I), I=1,5), J=1,85) /
     & 10,0.987226,-4.396825,-32.968494,40.900754,
     & 43,1.006045,-4.962611,-36.443637,44.72386,
     & 60,0.987563,-4.027958,-31.928229,40.082406,
     & 67,0.987563,-4.027958,-31.928229,40.082406,
     & 68,0.987563,-4.027958,-31.928229,40.082406,
     & 90,0.987226,-4.396825,-32.968494,40.900754,
     & 107,1.005598,-4.595382,-39.65777,48.447531,
     & 110,1.017129,-5.035009,-40.778119,49.493703,
     & 111,1.018317,-5.202751,-44.573295,53.682127,
     & 115,1.012739,-5.021693,-30.697896,38.676749,
     & 121,1.007357,-4.38353,-37.533739,46.221683,
     & 123,1.019967,-3.831951,-36.169514,44.588514,
     & 126,0.990799,-4.465552,-47.178011,56.153368,
     & 128,1.015474,-4.750206,-39.08175,47.663171,
     & 129,0.985634,-4.484123,-38.021863,46.299422,
     & 131,1.018534,-5.661877,-45.233296,54.320184,
     & 132,0.988876,-4.339684,-30.487486,37.943803,
     & 221,0.976887,-6.372196,-39.852794,47.638868,
     & 222,0.98278,-4.98044,-37.780331,45.512476,
     & 241,0.987226,-4.396825,-32.968494,40.900754,
     & 260,0.979075,-4.860084,-35.837266,43.682868,
     & 311,0.970888,-12.11488,-33.469593,40.320487,
     & 313,0.993648,-14.095485,-46.585716,54.641538,
     & 316,0.957247,-12.838405,-37.87306,44.91811,
     & 317,0.993648,-14.095485,-46.585716,54.641538,
     & 318,0.98667,-13.28569,-23.292189,29.47865,
     & 330,0.993648,-14.095485,-46.585716,54.641538,
     & 370,0.990427,-14.81679,-23.210675,29.141604,
     & 371,0.970888,-12.11488,-33.469593,40.320487,
     & 400,0.975054,-11.967499,-43.385922,51.122382,
     & 460,0.884844,-10.966955,-46.585716,54.641538,
     & 491,0.970888,-12.11488,-33.469593,40.320487,
     & 521,1.017439,-13.174563,-33.469593,40.320487,
     & 531,0.93924,-10.377629,-7.036861,11.665187,
     & 540,0.990354,-13.86657,-44.046785,51.632536,
     & 552,0.970888,-12.11488,-33.469593,40.320487,
     & 555,1.016073,-15.025004,-43.831114,51.473501,
     & 580,0.993648,-14.095485,-46.585716,54.641538,
     & 591,0.970888,-12.11488,-33.469593,40.320487,
     & 601,0.993648,-14.095485,-46.585716,54.641538,
     & 602,0.939211,-10.789604,-16.280751,21.457858,
     & 611,1.013706,-14.690715,-50.712592,59.264535,
     & 621,1.015683,-15.253771,-54.639851,63.549737,
     & 651,1.016073,-15.025004,-43.831114,51.473501,
     & 652,1.016073,-15.025004,-43.831114,51.473501,
     & 653,1.005781,-14.518615,-32.151472,38.751286,
     & 680,0.970888,-12.11488,-33.469593,40.320487,
     & 691,0.973498,-12.868316,-62.218744,70.635109,
     & 693,0.967984,-13.248708,-42.670508,50.056472,
     & 694,0.97595,-12.390384,-45.206541,53.020202,
     & 731,0.977294,-16.118257,-45.419797,53.050199,
     & 740,0.993648,-14.095485,-46.585716,54.641538,
     & 741,0.993648,-14.095485,-46.585716,54.641538,
     & 762,0.967082,-11.074226,-46.585716,54.641538,
     & 802,0.9849,-12.754068,-40.853917,48.314853,
     & 804,0.970577,-11.942936,-39.207446,46.599115,
     & 806,0.985882,-12.214161,-41.609919,49.261334,
     & 808,1.004199,-14.775319,-39.405006,46.869861,
     & 812,1.004199,-14.775319,-39.405006,46.869861,
     & 813,1.011594,-16.475117,-57.253809,66.161822,
     & 817,0.970577,-11.942936,-39.207446,46.599115,
     & 820,0.962858,-10.854013,-39.258381,46.972932,
     & 822,0.970577,-11.942936,-39.207446,46.599115,
     & 823,0.970577,-11.942936,-39.207446,46.599115,
     & 825,1.022046,-16.551048,-52.928852,61.52297,
     & 826,0.970577,-11.942936,-39.207446,46.599115,
     & 827,0.951738,-10.055145,-33.821051,41.219217,
     & 830,0.970577,-11.942936,-39.207446,46.599115,
     & 831,0.976525,-12.140112,-46.836658,55.060205,
     & 832,0.968616,-11.614055,-37.716845,44.770685,
     & 833,0.925404,-10.109039,-34.016058,40.773236,
     & 834,0.970577,-11.942936,-39.207446,46.599115,
     & 835,0.981927,-11.738632,-41.63764,49.438943,
     & 837,0.973573,-13.391067,-42.2359,49.659282,
     & 838,0.956531,-10.588513,-32.557196,39.284646,
     & 899,0.970577,-11.942936,-39.207446,46.599115,
     & 824,0.970577,-11.942936,-39.207446,46.599115,
     & 840,0.970577,-11.942936,-39.207446,46.599115,
     & 842,0.970577,-11.942936,-39.207446,46.599115,
     & 836,0.970577,-11.942936,-39.207446,46.599115,
     & 901,0.920003,-9.999206,-7.456203,11.992934,
     & 920,0.993648,-14.095485,-46.585716,54.641538,
     & 950,0.977669,-12.161698,-37.777411,44.944982,
     & 970,0.944758,-11.243663,-33.168491,39.961348,
     & 999,0.970577,-11.942936,-39.207446,46.599115/
      CV(DBH,HT,A1,A2) = A1 + A2*DBH**2*HT
      TRATIO(DBH,E1,E2) = E1 + E2*(1.0/(DBH-3.0))**2
      
      ERRFLG = 0
      IF(DBHOB.LT.1.0) ERRFLG = 3
      IF(HTTOT.LT.4.5) ERRFLG = 4
      IF(ERRFLG.GT.0) RETURN
      READ(VOLEQ(8:10),'(I3)')SPN
      CNT = 85
      IDX = 0
      CALL SEARCH_SP(CNT,VOLSP,SPN,IDX,ERRFLG)
      DBH = DBHOB
      HT = HTTOT
      IF(IDX.LE.0) THEN
        IF(DBH.LT.5.0)THEN
          VOL(4) = .045146+.002357*DBH**2*HT
        ELSE
          ERRFLG = 6
        ENDIF
        RETURN
      ENDIF
      IF(IDX.GT.0.AND.SPN.EQ.CUCOEF(IDX,1)) THEN
        CV4 = 0.0
        A1 = CUCOEF(IDX,2)
        A2 = CUCOEF(IDX,3)
        C1 = CUCOEF(IDX,4)
        C2 = CUCOEF(IDX,5)
        D1 = CUCOEF(IDX,6)
        D2 = CUCOEF(IDX,7)
        IF(BFMIND.LT.0.1)THEN
          IF(SPN.LT.300)THEN
            BFMIND = 9.0
          ELSE
            BFMIND = 11.0
          ENDIF
        ENDIF
!       SAPLINGS        
        IF(DBH.LT.5.0)THEN
          IF(VOLEQ(7:7).EQ.'0')THEN
            CV4 = CV(DBH,HT,A1,A2)
          ELSE
            IF(SPN.EQ.111)THEN
              B1 = 0.132056
              B2 = 0.002113
            ELSEIF(SPN.EQ.131)THEN
              B1 = 0.150292
              B2 = 0.001994
            ENDIF
            CV4 = CV(DBH,HT,B1,B2)
          ENDIF
!       POLES          
        ELSEIF(DBH.LT.BFMIND)THEN
          CV4 = CV(DBH,HT,C1,C2)
!       SAW TIMBER          
        ELSE
          CV4 = CV(DBH,HT,D1,D2)
        ENDIF
        VOL(4) = CV4
!       Convert CV4 to total cubic volume from stump to tip
        IF(DBH.LT.5.0)THEN
          TF = 1.0
        ELSE
          IF(DBH.LT.BFMIND)THEN
            E1 = TFCOEF(IDX,2)
            E2 = TFCOEF(IDX,3)
            TF = TRATIO(DBH,E1,E2)
          ELSE
            F1 = TFCOEF(IDX,2)
            F2 = TFCOEF(IDX,3)
            TF = TRATIO(DBH,F1,F2)
          ENDIF
          IF(VOLEQ(7:7).NE.'0')THEN
!           Plantation          
            IF(SPN.EQ.111)THEN
              G1 = 1.081908
              G2 = 2.607333
            ELSEIF(SPN.EQ.131)THEN
              G1 = 1.081556
              G2 = 3.65992
            ENDIF 
            TF = TRATIO(DBH,G1,G2)
          ENDIF
        ENDIF
        TCU = CV4*TF
        VOL(1) = TCU
!       Converts cubic volume to a 4 inch top to cubic for sawlog portion of tree
        IF(DBH.GE.BFMIND)THEN
          H1 = BFCOEF(IDX,2)
          H2 = BFCOEF(IDX,3)
          RC = H1 + H2*(1.0/(DBH-5.0))**2
          IF(RC.GT.0.99) RC = 0.99
          IF(RC.LT.0.6) RC = 0.6
          MCU = CV4*RC
          VOL(7) = CV4 - MCU
          VOL(4) = MCU
          I1 = BFCOEF(IDX,4)
          I2 = BFCOEF(IDX,5)
          RB = I1 + I2*(1.0-1.0/DBH)  
          BD = RB*CV4
          VOL(10) = BD
        ENDIF      
      ENDIF
      RETURN
      END SUBROUTINE SRS_VOL
! ---------------------------------------------------------------------
! Volume quation for paulownia
! Reference:
! Berg, EC etal 2019. Survivorship, attained diameter, height and volume of three
! Paulownia species after 9 years in the southern Appalachians,USA. J. For. Res.    
! Equation number:
! S00BER0712 (DBH only), S01BER0712 (D2H), S02BER0712 (DRC, THT)
      SUBROUTINE BERG_VOL(VOLEQ,DBHOB,HTTOT,VOL,ERRFLG)
      REAL DBHOB,HTTOT,VOL(15),D,H,V,D1,STUMPV,TIPV,D2,TIPL
      CHARACTER*10 VOLEQ
      INTEGER ERRFLG
      ERRFLG = 0
! CONVERT DBHOB FROM IN TO CM, HTTOT FROM FT TO M
      D = DBHOB*2.54
      H = HTTOT*0.3048
      V = 0.0
      IF((VOLEQ(2:3).EQ.'01'.OR.VOLEQ(2:3).EQ.'02')
     &   .AND.HTTOT.LT.4.5)THEN
        ERRFLG = 4
        RETURN
      ENDIF
      IF(VOLEQ(2:3).EQ.'00')THEN
        V = 0.0004*D*D
      ELSEIF(VOLEQ(2:3).EQ.'01')THEN
        V=EXP(-8.5006+0.7891*LOG(D*D*H))
      ELSEIF(VOLEQ(2:3).EQ.'02')THEN
        V=EXP(-9.848+0.859*LOG(D*D*H))
      ELSE
        ERRFLG = 1
        RETURN
      ENDIF
! CONVERT V FROM CUBIC M TO CUBIC FT  
      V = V*35.3147
      VOL(1) = V

! Calculate merch vol for DBHOB > 5 inch
      IF(VOLEQ(2:3).EQ.'02')THEN
        D = (D-3.212)/1.296
        DBHOB = D*0.3937
      ENDIF
      IF(HTTOT.LE.0.0)THEN
        H = 0.747 + 3.73*LOG(D)
        HTTOT = H/0.3048
      ENDIF
      IF(DBHOB.GE.5.0.AND.HTTOT.GT.5.0)THEN
! Diameter at ground level
        D1= 3.212 + 1.296*D
! Convert D1 from cm to in
        D1 = D1*0.3937        
! Diameter at 0.5 ft stump        
        D2 = SQRT(D1*D1-(D1*D1-DBHOB*DBHOB)*(0.5/4.5))
        STUMPV = (D1*D1+D2*D2)*0.5*0.0027274
! Tip length
        TIPL = (HTTOT-4.5)*(16.0/(DBHOB*DBHOB))
! Top Vol        
        TIPV = 16.0*TIPL*0.0027274   
        VOL(4) = V-STUMPV-TIPV
        VOL(14) = STUMPV
        VOL(15) = TIPV     
      ENDIF             
      RETURN
      END SUBROUTINE BERG_VOL            